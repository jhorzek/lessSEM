<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="lessSEM">
<title>Mixed Penalties • lessSEM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mixed Penalties">
<meta property="og:description" content="lessSEM">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lessSEM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/lessSEM.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Definition-Variables-and-Multi-Group-SEM.html">Definition-Variables-and-Multi-Group-SEM</a>
    <a class="dropdown-item" href="../articles/Estimator-Settings.html">Estimator-Settings</a>
    <a class="dropdown-item" href="../articles/General-Purpose-Optimization.html">General-Purpose-Optimization</a>
    <a class="dropdown-item" href="../articles/Mixed-Penalties.html">Mixed Penalties</a>
    <a class="dropdown-item" href="../articles/Parameter-transformations.html">Parameter-transformations</a>
    <a class="dropdown-item" href="../articles/SCAD-and-MCP.html">SCAD-and-MCP</a>
    <a class="dropdown-item" href="../articles/The-Structural-Equation-Model.html">The-Structural-Equation-Model</a>
    <a class="dropdown-item" href="../articles/The-optimizer-interface.html">The-optimizer-interface</a>
    <a class="dropdown-item" href="../articles/log-likelihood-gradients.html">log-likelihood-gradients</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jhorzek/lessSEM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Mixed Penalties</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jhorzek/lessSEM/blob/HEAD/vignettes/Mixed-Penalties.Rmd" class="external-link"><code>vignettes/Mixed-Penalties.Rmd</code></a></small>
      <div class="d-none name"><code>Mixed-Penalties.Rmd</code></div>
    </div>

    
    
<blockquote>
<p><strong>This is an experimental feature. There may be bugs; use
carefully!</strong></p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jhorzek/lessSEM" class="external-link">lessSEM</a></span><span class="op">)</span></span></code></pre></div>
<p>The <code>mixedPenalty</code> function allows you to add multiple
penalties to a single model. For instance, you may want to regularize
both loadings and regressions in a SEM. In this case, using the same
penalty (e.g., lasso) for both types of penalties may actually not be
what you want to use because the penalty function is sensitive to the
scales of the parameters. Instead, you may want to use two separate
lasso penalties for loadings and regressions. Similarly, separate
penalties for different parameters have, for instance, been proposed in
multi-group models (Geminiani et al., 2021).</p>
<blockquote>
<p>Important: You cannot impose two penalties on the same parameter!</p>
</blockquote>
<p>Models are fitted with the glmnet or ista optimizer. Note that the
optimizers differ in which penalties they support. The following table
provides an overview:</p>
<table class="table">
<thead><tr class="header">
<th>Penalty</th>
<th>Function</th>
<th>glmnet</th>
<th>ista</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>lasso</td>
<td>addLasso</td>
<td>x</td>
<td>x</td>
</tr>
<tr class="even">
<td>elastic net</td>
<td>addElasticNet</td>
<td>x*</td>
<td>-</td>
</tr>
<tr class="odd">
<td>cappedL1</td>
<td>addCappedL1</td>
<td>x</td>
<td>x</td>
</tr>
<tr class="even">
<td>lsp</td>
<td>addLsp</td>
<td>x</td>
<td>x</td>
</tr>
<tr class="odd">
<td>scad</td>
<td>addScad</td>
<td>x</td>
<td>x</td>
</tr>
<tr class="even">
<td>mcp</td>
<td>addMcp</td>
<td>x</td>
<td>x</td>
</tr>
</tbody>
</table>
<p>By default, glmnet will be used. Note that the elastic net penalty
can only be combined with other elastic net penalties.</p>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>In the following model, we will allow for cross-loadings
(<code>c2</code>-<code>c4</code>). We want to regularize both,
cross-loadings and regression coefficients (<code>r1</code> -
<code>r3</code>)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">' </span></span>
<span><span class="st">  # latent variable definitions</span></span>
<span><span class="st">     ind60 =~ x1 + x2 + x3 + c2*y2 + c3*y3 + c4*y4</span></span>
<span><span class="st">     dem60 =~ y1 + y2 + y3 + y4</span></span>
<span><span class="st">     dem65 =~ y5 + y6 + y7 + c*y8</span></span>
<span><span class="st"></span></span>
<span><span class="st">  # regressions</span></span>
<span><span class="st">    dem60 ~ r1*ind60</span></span>
<span><span class="st">    dem65 ~ r2*ind60 + r3*dem60</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="va">lavaanModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span><span class="va">model</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">PoliticalDemocracy</span><span class="op">)</span></span></code></pre></div>
<p>Next, we add separate lasso penalties for the loadings and the
regressions:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mp</span> <span class="op">&lt;-</span> <span class="va">lavaanModel</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mixedPenalty.html">mixedPenalty</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/addLasso.html">addLasso</a></span><span class="op">(</span>regularized <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c2"</span>, <span class="st">"c3"</span>, <span class="st">"c4"</span><span class="op">)</span>, </span>
<span>           lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">.1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/addLasso.html">addLasso</a></span><span class="op">(</span>regularized <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r1"</span>, <span class="st">"r2"</span>, <span class="st">"r3"</span><span class="op">)</span>, </span>
<span>           lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">.2</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p>Note that we can use the pipe-operator to add multiple penalties.
They don’t have to be the same; the following would also work:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mp</span> <span class="op">&lt;-</span> <span class="va">lavaanModel</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mixedPenalty.html">mixedPenalty</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/addLasso.html">addLasso</a></span><span class="op">(</span>regularized <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c2"</span>, <span class="st">"c3"</span>, <span class="st">"c4"</span><span class="op">)</span>, </span>
<span>           lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">.1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/addScad.html">addScad</a></span><span class="op">(</span>regularized <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r1"</span>, <span class="st">"r2"</span>, <span class="st">"r3"</span><span class="op">)</span>, </span>
<span>          lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">.2</span><span class="op">)</span>,</span>
<span>          thetas <span class="op">=</span> <span class="fl">3.7</span><span class="op">)</span> </span></code></pre></div>
<p>To fit the model, we use the <code>fit</code>- function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitMp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span><span class="va">mp</span><span class="op">)</span></span></code></pre></div>
<p>To check which parameter has be regularized with which penalty, we
can look at the <code>penalty</code> statement in the resulting
object:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitMp</span><span class="op">@</span><span class="va">penalty</span></span>
<span><span class="co">#&gt;    ind60=~x2    ind60=~x3           c2           c3           c4    dem60=~y2 </span></span>
<span><span class="co">#&gt;       "none"       "none"      "lasso"      "lasso"      "lasso"       "none" </span></span>
<span><span class="co">#&gt;    dem60=~y3    dem60=~y4    dem65=~y6    dem65=~y7            c           r1 </span></span>
<span><span class="co">#&gt;       "none"       "none"       "none"       "none"       "none"       "scad" </span></span>
<span><span class="co">#&gt;           r2           r3       x1~~x1       x2~~x2       x3~~x3       y2~~y2 </span></span>
<span><span class="co">#&gt;       "scad"       "scad"       "none"       "none"       "none"       "none" </span></span>
<span><span class="co">#&gt;       y3~~y3       y4~~y4       y1~~y1       y5~~y5       y6~~y6       y7~~y7 </span></span>
<span><span class="co">#&gt;       "none"       "none"       "none"       "none"       "none"       "none" </span></span>
<span><span class="co">#&gt;       y8~~y8 ind60~~ind60 dem60~~dem60 dem65~~dem65 </span></span>
<span><span class="co">#&gt;       "none"       "none"       "none"       "none"</span></span></code></pre></div>
<p>We can access the best parameters according to the BIC with:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fitMp</span>, criterion <span class="op">=</span> <span class="st">"BIC"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                                      </span></span>
<span><span class="co">#&gt;                        Tuning ||--||  Estimates                      </span></span>
<span><span class="co">#&gt;  ---------------------------- ||--|| ---------- ---------- ----------</span></span>
<span><span class="co">#&gt;  tuningParameterConfiguration ||--||  ind60=~x2  ind60=~x3         c2</span></span>
<span><span class="co">#&gt;  ============================ ||--|| ========== ========== ==========</span></span>
<span><span class="co">#&gt;                       11.0000 ||--||     2.1817     1.8188          .</span></span>
<span><span class="co">#&gt;                                                                              </span></span>
<span><span class="co">#&gt;                                                                              </span></span>
<span><span class="co">#&gt;  ---------- ---------- ---------- ---------- ---------- ---------- ----------</span></span>
<span><span class="co">#&gt;          c3         c4  dem60=~y2  dem60=~y3  dem60=~y4  dem65=~y6  dem65=~y7</span></span>
<span><span class="co">#&gt;  ========== ========== ========== ========== ========== ========== ==========</span></span>
<span><span class="co">#&gt;           .          .     1.3540     1.0440     1.2995     1.2585     1.2825</span></span>
<span><span class="co">#&gt;                                                                              </span></span>
<span><span class="co">#&gt;                                                                              </span></span>
<span><span class="co">#&gt;  ---------- ---------- ---------- ---------- ---------- ---------- ----------</span></span>
<span><span class="co">#&gt;           c         r1         r2         r3     x1~~x1     x2~~x2     x3~~x3</span></span>
<span><span class="co">#&gt;  ========== ========== ========== ========== ========== ========== ==========</span></span>
<span><span class="co">#&gt;      1.3098     1.4738     0.4533     0.8644     0.0818     0.1184     0.4673</span></span>
<span><span class="co">#&gt;                                                                              </span></span>
<span><span class="co">#&gt;                                                                              </span></span>
<span><span class="co">#&gt;  ---------- ---------- ---------- ---------- ---------- ---------- ----------</span></span>
<span><span class="co">#&gt;      y2~~y2     y3~~y3     y4~~y4     y1~~y1     y5~~y5     y6~~y6     y7~~y7</span></span>
<span><span class="co">#&gt;  ========== ========== ========== ========== ========== ========== ==========</span></span>
<span><span class="co">#&gt;      6.4896     5.3399     2.8871     1.9419     2.3901     4.3428     3.5096</span></span>
<span><span class="co">#&gt;                                                   </span></span>
<span><span class="co">#&gt;                                                   </span></span>
<span><span class="co">#&gt;  ---------- ------------ ------------ ------------</span></span>
<span><span class="co">#&gt;      y8~~y8 ind60~~ind60 dem60~~dem60 dem65~~dem65</span></span>
<span><span class="co">#&gt;  ========== ============ ============ ============</span></span>
<span><span class="co">#&gt;      2.9403       0.4482       3.8717       0.1149</span></span></code></pre></div>
<p>The <code>tuningParameterConfiguration</code> refers to the rows in
the lambda, theta, and alpha matrices that resulted in the best fit:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getTuningParameterConfiguration.html">getTuningParameterConfiguration</a></span><span class="op">(</span>regularizedSEMMixedPenalty <span class="op">=</span> <span class="va">fitMp</span>, </span>
<span>                                tuningParameterConfiguration <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 parameter penalty lambda alpha</span></span>
<span><span class="co">#&gt; ind60=~x2       ind60=~x2    none      0     0</span></span>
<span><span class="co">#&gt; ind60=~x3       ind60=~x3    none      0     0</span></span>
<span><span class="co">#&gt; c2                     c2   lasso      1     1</span></span>
<span><span class="co">#&gt; c3                     c3   lasso      1     1</span></span>
<span><span class="co">#&gt; c4                     c4   lasso      1     1</span></span>
<span><span class="co">#&gt; dem60=~y2       dem60=~y2    none      0     0</span></span>
<span><span class="co">#&gt; dem60=~y3       dem60=~y3    none      0     0</span></span>
<span><span class="co">#&gt; dem60=~y4       dem60=~y4    none      0     0</span></span>
<span><span class="co">#&gt; dem65=~y6       dem65=~y6    none      0     0</span></span>
<span><span class="co">#&gt; dem65=~y7       dem65=~y7    none      0     0</span></span>
<span><span class="co">#&gt; c                       c    none      0     0</span></span>
<span><span class="co">#&gt; r1                     r1    scad      0     0</span></span>
<span><span class="co">#&gt; r2                     r2    scad      0     0</span></span>
<span><span class="co">#&gt; r3                     r3    scad      0     0</span></span>
<span><span class="co">#&gt; x1~~x1             x1~~x1    none      0     0</span></span>
<span><span class="co">#&gt; x2~~x2             x2~~x2    none      0     0</span></span>
<span><span class="co">#&gt; x3~~x3             x3~~x3    none      0     0</span></span>
<span><span class="co">#&gt; y2~~y2             y2~~y2    none      0     0</span></span>
<span><span class="co">#&gt; y3~~y3             y3~~y3    none      0     0</span></span>
<span><span class="co">#&gt; y4~~y4             y4~~y4    none      0     0</span></span>
<span><span class="co">#&gt; y1~~y1             y1~~y1    none      0     0</span></span>
<span><span class="co">#&gt; y5~~y5             y5~~y5    none      0     0</span></span>
<span><span class="co">#&gt; y6~~y6             y6~~y6    none      0     0</span></span>
<span><span class="co">#&gt; y7~~y7             y7~~y7    none      0     0</span></span>
<span><span class="co">#&gt; y8~~y8             y8~~y8    none      0     0</span></span>
<span><span class="co">#&gt; ind60~~ind60 ind60~~ind60    none      0     0</span></span>
<span><span class="co">#&gt; dem60~~dem60 dem60~~dem60    none      0     0</span></span>
<span><span class="co">#&gt; dem65~~dem65 dem65~~dem65    none      0     0</span></span></code></pre></div>
<p>In this case, the best model has no cross-loadings, but the
regressions remained unregularized: The lambda for the cross-loadings is
large (1), while the lambda for the regressions is 0 (no
regularization).</p>
</div>
<div class="section level2">
<h2 id="using-ista">Using ista<a class="anchor" aria-label="anchor" href="#using-ista"></a>
</h2>
<p>The glmnet optimizer is typically considerably faster than ista.
However, sometimes glmnet may run into issues. In that case, it can help
to switch to ista:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mp</span> <span class="op">&lt;-</span> <span class="va">lavaanModel</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Change the optimizer and the control object:</span></span>
<span>  <span class="fu"><a href="../reference/mixedPenalty.html">mixedPenalty</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"ista"</span>,</span>
<span>               control <span class="op">=</span> <span class="fu"><a href="../reference/controlIsta.html">controlIsta</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/addLasso.html">addLasso</a></span><span class="op">(</span>regularized <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c2"</span>, <span class="st">"c3"</span>, <span class="st">"c4"</span><span class="op">)</span>, </span>
<span>                lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">.1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/addLasso.html">addLasso</a></span><span class="op">(</span>regularized <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r1"</span>, <span class="st">"r2"</span>, <span class="st">"r3"</span><span class="op">)</span>, </span>
<span>                lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">.2</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p>To fit the model, we use the <code>fit</code>- function:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitMp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span><span class="va">mp</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fitMp</span>, criterion <span class="op">=</span> <span class="st">"BIC"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                                      </span></span>
<span><span class="co">#&gt;                        Tuning ||--||  Estimates                      </span></span>
<span><span class="co">#&gt;  ---------------------------- ||--|| ---------- ---------- ----------</span></span>
<span><span class="co">#&gt;  tuningParameterConfiguration ||--||  ind60=~x2  ind60=~x3         c2</span></span>
<span><span class="co">#&gt;  ============================ ||--|| ========== ========== ==========</span></span>
<span><span class="co">#&gt;                       11.0000 ||--||     2.1818     1.8188          .</span></span>
<span><span class="co">#&gt;                                                                              </span></span>
<span><span class="co">#&gt;                                                                              </span></span>
<span><span class="co">#&gt;  ---------- ---------- ---------- ---------- ---------- ---------- ----------</span></span>
<span><span class="co">#&gt;          c3         c4  dem60=~y2  dem60=~y3  dem60=~y4  dem65=~y6  dem65=~y7</span></span>
<span><span class="co">#&gt;  ========== ========== ========== ========== ========== ========== ==========</span></span>
<span><span class="co">#&gt;           .          .     1.3541     1.0441     1.2997     1.2586     1.2825</span></span>
<span><span class="co">#&gt;                                                                              </span></span>
<span><span class="co">#&gt;                                                                              </span></span>
<span><span class="co">#&gt;  ---------- ---------- ---------- ---------- ---------- ---------- ----------</span></span>
<span><span class="co">#&gt;           c         r1         r2         r3     x1~~x1     x2~~x2     x3~~x3</span></span>
<span><span class="co">#&gt;  ========== ========== ========== ========== ========== ========== ==========</span></span>
<span><span class="co">#&gt;      1.3099     1.4740     0.4532     0.8643     0.0818     0.1184     0.4672</span></span>
<span><span class="co">#&gt;                                                                              </span></span>
<span><span class="co">#&gt;                                                                              </span></span>
<span><span class="co">#&gt;  ---------- ---------- ---------- ---------- ---------- ---------- ----------</span></span>
<span><span class="co">#&gt;      y2~~y2     y3~~y3     y4~~y4     y1~~y1     y5~~y5     y6~~y6     y7~~y7</span></span>
<span><span class="co">#&gt;  ========== ========== ========== ========== ========== ========== ==========</span></span>
<span><span class="co">#&gt;      6.4892     5.3396     2.8861     1.9420     2.3904     4.3421     3.5090</span></span>
<span><span class="co">#&gt;                                                   </span></span>
<span><span class="co">#&gt;                                                   </span></span>
<span><span class="co">#&gt;  ---------- ------------ ------------ ------------</span></span>
<span><span class="co">#&gt;      y8~~y8 ind60~~ind60 dem60~~dem60 dem65~~dem65</span></span>
<span><span class="co">#&gt;  ========== ============ ============ ============</span></span>
<span><span class="co">#&gt;      2.9392       0.4482       3.8710       0.1159</span></span></code></pre></div>
<p>The <code>tuningParameterConfiguration</code> refers to the rows in
the lambda, theta, and alpha matrices that resulted in the best fit:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getTuningParameterConfiguration.html">getTuningParameterConfiguration</a></span><span class="op">(</span>regularizedSEMMixedPenalty <span class="op">=</span> <span class="va">fitMp</span>, </span>
<span>                                tuningParameterConfiguration <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 parameter penalty lambda theta alpha</span></span>
<span><span class="co">#&gt; ind60=~x2       ind60=~x2    none      0     0     0</span></span>
<span><span class="co">#&gt; ind60=~x3       ind60=~x3    none      0     0     0</span></span>
<span><span class="co">#&gt; c2                     c2   lasso      1     0     1</span></span>
<span><span class="co">#&gt; c3                     c3   lasso      1     0     1</span></span>
<span><span class="co">#&gt; c4                     c4   lasso      1     0     1</span></span>
<span><span class="co">#&gt; dem60=~y2       dem60=~y2    none      0     0     0</span></span>
<span><span class="co">#&gt; dem60=~y3       dem60=~y3    none      0     0     0</span></span>
<span><span class="co">#&gt; dem60=~y4       dem60=~y4    none      0     0     0</span></span>
<span><span class="co">#&gt; dem65=~y6       dem65=~y6    none      0     0     0</span></span>
<span><span class="co">#&gt; dem65=~y7       dem65=~y7    none      0     0     0</span></span>
<span><span class="co">#&gt; c                       c    none      0     0     0</span></span>
<span><span class="co">#&gt; r1                     r1   lasso      0     0     1</span></span>
<span><span class="co">#&gt; r2                     r2   lasso      0     0     1</span></span>
<span><span class="co">#&gt; r3                     r3   lasso      0     0     1</span></span>
<span><span class="co">#&gt; x1~~x1             x1~~x1    none      0     0     0</span></span>
<span><span class="co">#&gt; x2~~x2             x2~~x2    none      0     0     0</span></span>
<span><span class="co">#&gt; x3~~x3             x3~~x3    none      0     0     0</span></span>
<span><span class="co">#&gt; y2~~y2             y2~~y2    none      0     0     0</span></span>
<span><span class="co">#&gt; y3~~y3             y3~~y3    none      0     0     0</span></span>
<span><span class="co">#&gt; y4~~y4             y4~~y4    none      0     0     0</span></span>
<span><span class="co">#&gt; y1~~y1             y1~~y1    none      0     0     0</span></span>
<span><span class="co">#&gt; y5~~y5             y5~~y5    none      0     0     0</span></span>
<span><span class="co">#&gt; y6~~y6             y6~~y6    none      0     0     0</span></span>
<span><span class="co">#&gt; y7~~y7             y7~~y7    none      0     0     0</span></span>
<span><span class="co">#&gt; y8~~y8             y8~~y8    none      0     0     0</span></span>
<span><span class="co">#&gt; ind60~~ind60 ind60~~ind60    none      0     0     0</span></span>
<span><span class="co">#&gt; dem60~~dem60 dem60~~dem60    none      0     0     0</span></span>
<span><span class="co">#&gt; dem65~~dem65 dem65~~dem65    none      0     0     0</span></span></code></pre></div>
<p>Here is a short run-time comparison of ista and glmnet with the
lasso-regularized model from above: Five repetitions using ista took
18.097 seconds, while glmnet took 1.081 seconds. That is, if you can use
glmnet with your model, we recommend that you do.</p>
</div>
<div class="section level2">
<h2 id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<ul>
<li>Geminiani, E., Marra, G., &amp; Moustaki, I. (2021). Single- and
multiple-group penalized factor analysis: A trust-region algorithm
approach with integrated automatic multiple tuning parameter selection.
Psychometrika, 86(1), 65–95. <a href="https://doi.org/10.1007/s11336-021-09751-8" class="external-link uri">https://doi.org/10.1007/s11336-021-09751-8</a>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jannik H. Orzek.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
