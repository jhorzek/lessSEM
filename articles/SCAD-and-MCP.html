<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="lessSEM">
<title>SCAD-and-MCP • lessSEM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SCAD-and-MCP">
<meta property="og:description" content="lessSEM">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lessSEM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/lessSEM.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Definition-Variables-and-Multi-Group-SEM.html">Definition-Variables-and-Multi-Group-SEM</a>
    <a class="dropdown-item" href="../articles/General-Purpose-Optimization.html">General-Purpose-Optimization</a>
    <a class="dropdown-item" href="../articles/Mixed-Penalties.html">Mixed Penalties</a>
    <a class="dropdown-item" href="../articles/Parameter-transformations.html">Parameter-transformations</a>
    <a class="dropdown-item" href="../articles/SCAD-and-MCP.html">SCAD-and-MCP</a>
    <a class="dropdown-item" href="../articles/The-Structural-Equation-Model.html">The-Structural-Equation-Model</a>
    <a class="dropdown-item" href="../articles/The-optimizer-interface.html">The-optimizer-interface</a>
    <a class="dropdown-item" href="../articles/log-likelihood-gradients.html">log-likelihood-gradients</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jhorzek/lessSEM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>SCAD-and-MCP</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jhorzek/lessSEM/blob/HEAD/vignettes/SCAD-and-MCP.Rmd" class="external-link"><code>vignettes/SCAD-and-MCP.Rmd</code></a></small>
      <div class="d-none name"><code>SCAD-and-MCP.Rmd</code></div>
    </div>

    
    
<p>We implemented variants of the iterative shrinkage and thresholding
(e.g., Beck &amp; Teboulle, 2009; Gong et al., 2013; Parikh &amp; Boyd,
2013) optimizer for all penalty functions. Solutions for the lasso,
cappedL1, mcp, and scad are proposed by Gong et al. (2013).
Unfortunately, we could not get the mcp and scad to work in lessSEM,
which is most likely due to us misunderstanding the derivation presented
by Gong et al. (2013). The current implementation is based on the same
idea as that used by Gong et al. (2013) and is outlined in the
following.</p>
<div class="section level2">
<h2 id="scad">SCAD<a class="anchor" aria-label="anchor" href="#scad"></a>
</h2>
<p>The scad penalty is given by:</p>
<p><span class="math display">\[p(x) = \begin{cases}
\lambda |x| &amp; \text{if } |x| \leq \theta\\
\frac{-x^2 + 2\theta\lambda |x| - \lambda^2}{2(\theta -1)} &amp;
\text{if } \lambda &lt; |x| &lt; \lambda\theta\\
(\theta + 1) \lambda^2/2 &amp; \text{if } |x| \geq \theta\lambda\\
\end{cases}\]</span></p>
<p>with <span class="math inline">\(\theta &gt; 2\)</span> and <span class="math inline">\(\lambda \geq 0\)</span>. For the proximal operator
we are searching a solution for the function <span class="math inline">\(\hat x = \arg\min_x \frac 12 (x-u)^2 + \frac 1t
p(x)\)</span>. The idea of Gong et al. (2013) is to minimze this
function for each of the regions mentioned above and to compare these
minima to find the global minimum.</p>
<div class="section level3">
<h3 id="assume-x-leq-lambda">Assume: <span class="math inline">\(|x| \leq \lambda\)</span><a class="anchor" aria-label="anchor" href="#assume-x-leq-lambda"></a>
</h3>
<p>Assuming that the solution is in the region <span class="math inline">\(|x| \leq \lambda\)</span>, the scad is identical
to the lasso. It follows:</p>
<p><span class="math display">\[\hat x = \text{sign}
(u)\max(0,|u|-\lambda / t)\]</span> If we also take the border <span class="math inline">\(|x| \leq \lambda\)</span> into account, it
follows:</p>
<ol style="list-style-type: decimal">
<li>If <span class="math inline">\(x \geq 0\)</span>: <span class="math inline">\(\hat x = \min(\lambda, \text{sign}
(u)\max(0,|u|-\lambda / t))\)</span>
</li>
<li>If <span class="math inline">\(x \leq 0\)</span>: <span class="math inline">\(\hat x = \max(-\lambda, \text{sign}
(u)\max(0,|u|-\lambda / t))\)</span>
</li>
</ol>
<p>Combined:</p>
<p><span class="math display">\[\hat x = \text{sign}(u)\max(\lambda,
\max(0,|u|-\lambda / t))\]</span></p>
</div>
<div class="section level3">
<h3 id="assume-lambda-x-leq-lambdatheta">Assume: <span class="math inline">\(\lambda &lt; |x| \leq
\lambda\theta\)</span><a class="anchor" aria-label="anchor" href="#assume-lambda-x-leq-lambdatheta"></a>
</h3>
<p>Assuming that the solution is in the region <span class="math inline">\(\lambda &lt; |x| \leq \lambda\theta\)</span>, the
critical section of the absolute value function (<span class="math inline">\(x=0\)</span>) is avoided. Therefore, the
derivative with respect to <span class="math inline">\(x\)</span> is
defined and can be set to zero. The solution is given by:</p>
<p><span class="math display">\[
\hat x = \begin{cases}
\frac{u}{v} - \frac{\theta\lambda}{t(\theta-1)v} &amp; \text{if }
\lambda &lt; x &lt;= \lambda\theta\\
\frac{u}{v} + \frac{\theta\lambda}{t(\theta-1)v} &amp; \text{if
}  -\theta &gt; x &gt; -\lambda\theta \\
\end{cases}
\]</span></p>
<p>with <span class="math inline">\(v =
(1-\frac{1}{t(\theta-1)})\)</span>. Also accounting for the borders
gives:</p>
<p><span class="math display">\[
\hat x = \begin{cases}
\min(\lambda\theta, \max(\lambda, \frac{u}{v} -
\frac{\theta\lambda}{t(\theta-1)v}) &amp; \text{if } x \geq 0\\
\max(-\lambda\theta, \min(-\lambda, \frac{u}{v} +
\frac{\theta\lambda}{t(\theta-1)v}) &amp; \text{if } x \leq 0\\
\end{cases}
\]</span></p>
<p>Derivation:</p>
<p>The penalty is given by <span class="math inline">\(\frac{-x^2 +
2\theta\lambda |x| - \lambda^2}{2(\theta -1)}\)</span>. Differentiation
with respect to <span class="math inline">\(x\)</span> gives:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; \frac{(-2x + 2\theta\lambda \text{sign}(x))*2(\theta
-1)}{(2(\theta -1))^2} \\
&amp;= \frac{-x + \theta\lambda \text{sign}(x)}{(\theta -1)}
\end{aligned}
\]</span></p>
<p>(Note: as indicated above, <span class="math inline">\(x \neq
0\)</span> because <span class="math inline">\(\lambda &lt; |x| \leq
\lambda\theta\)</span>. This <span class="math inline">\(\partial |x| =
\text{sign}(x)*1\)</span>.)</p>
<p>Now we combine the differentiation of the penalty with the
differentiation of <span class="math inline">\(\frac 12 (x-u)^2\)</span>
and set to 0: <span class="math display">\[x-u + \frac 1t \frac{-x +
\theta\lambda \text{sign}(x)}{(\theta -1)} := 0\]</span> We get the
equations above as solution.</p>
</div>
<div class="section level3">
<h3 id="assume-x-geq-thetalambda">Assume: <span class="math inline">\(|x| \geq
\theta\lambda\)</span><a class="anchor" aria-label="anchor" href="#assume-x-geq-thetalambda"></a>
</h3>
<p>As <span class="math inline">\(x \neq 0\)</span>, the differentiation
with respect to <span class="math inline">\(x\)</span> is defined. The
penalty is given by <span class="math inline">\((\theta + 1)
\lambda^2/2\)</span>. Differentiating with respect to <span class="math inline">\(x\)</span> gives <span class="math inline">\(0\)</span> as solution. It follows:</p>
<p><span class="math display">\[x-u + \frac 1t 0 := 0 \Rightarrow \hat x
= u\]</span></p>
<p>Respecting the borders:</p>
<p><span class="math display">\[\hat x = \text{sign}(u)
\min(\theta\lambda, |u|)\]</span></p>
</div>
<div class="section level3">
<h3 id="combining-the-solutions">combining the solutions<a class="anchor" aria-label="anchor" href="#combining-the-solutions"></a>
</h3>
<p>We now have minima for each section of the penalty function. To find
the global minimum, we have to compute <span class="math inline">\(\frac
12 (x-u)^2 + \frac 1t p(x)\)</span> for each proposed solution and then
select the one which results in the smallest value.</p>
</div>
</div>
<div class="section level2">
<h2 id="mcp">MCP<a class="anchor" aria-label="anchor" href="#mcp"></a>
</h2>
<p>The MCP is defined as</p>
<p><span class="math display">\[
p(x) =
\begin{cases}
\lambda |x| - x^2/(2\theta) &amp; \text{if } |x| \leq \theta\lambda\\
\theta\lambda^2/2 &amp; \text{if } |x| &gt; \lambda\theta
\end{cases}; \theta &gt; 0
\]</span></p>
<div class="section level3">
<h3 id="assume-x-leq-thetalambda">Assume: <span class="math inline">\(|x| \leq
\theta\lambda\)</span><a class="anchor" aria-label="anchor" href="#assume-x-leq-thetalambda"></a>
</h3>
<div class="section level4">
<h4 id="assume-that-the-solution-is-given-by-x-geq-0-">Assume that the solution is given by <span class="math inline">\(x
\geq 0\)</span>.<a class="anchor" aria-label="anchor" href="#assume-that-the-solution-is-given-by-x-geq-0-"></a>
</h4>
<p>Then <span class="math inline">\(\frac{\partial}{\partial x}p(x) =
\lambda - \frac x\theta\)</span>. It follows that the minimum of <span class="math inline">\(f(x) = \frac 12 (x-u)^2 + \frac 1t p(x)\)</span>
is given by</p>
<p><span class="math display">\[
\begin{aligned}
x-u + \frac 1t (\lambda - \frac x\theta) &amp;:= 0\\
\Rightarrow x = \frac u v - \frac{1}{tv}\lambda
\end{aligned}
\]</span> where <span class="math inline">\(v = 1-\frac{1}{\theta
t}\)</span></p>
<p>Respecting the borders:</p>
<p><span class="math display">\[x = \max(0,\min(\frac u v -
\frac{1}{tv}\lambda, \theta\lambda))\]</span></p>
</div>
<div class="section level4">
<h4 id="assume-that-the-solution-is-given-by-x-leq-0-">Assume that the solution is given by <span class="math inline">\(x
\leq 0\)</span>.<a class="anchor" aria-label="anchor" href="#assume-that-the-solution-is-given-by-x-leq-0-"></a>
</h4>
<p>Then <span class="math inline">\(\frac{\partial}{\partial x}p(x) =
-\lambda - \frac x\theta\)</span>. It follows that the minimum of <span class="math inline">\(f(x) = \frac 12 (x-u)^2 + \frac 1t p(x)\)</span>
is given by</p>
<p><span class="math display">\[
\begin{aligned}
x-u + \frac 1t (-\lambda - \frac x\theta) &amp;:= 0\\
\Rightarrow x = \frac u v + \frac{1}{tv}\lambda
\end{aligned}
\]</span> where <span class="math inline">\(v = 1-\frac{1}{\theta
t}\)</span></p>
<p>Respecting the borders:</p>
<p><span class="math display">\[x = \min(0,\max(\frac u v +
\frac{1}{tv}\lambda, -\theta\lambda))\]</span></p>
</div>
</div>
<div class="section level3">
<h3 id="assume-x-geq-thetalambda-1">Assume <span class="math inline">\(|x| \geq
\theta\lambda\)</span><a class="anchor" aria-label="anchor" href="#assume-x-geq-thetalambda-1"></a>
</h3>
<p>In this case, the differentiation with respect to <span class="math inline">\(x\)</span> is well defined. We get <span class="math inline">\(\frac{\partial}{\partial x}p(x) = 0\)</span> and
<span class="math inline">\(x = u\)</span> as minimum of the function.
Respecting the borders: <span class="math display">\[x =
\text{sign}(u)\max(\theta\lambda, |u|)\]</span></p>
<p>Finally, we are going to compare all proposed minima and select the
one which actually minimizes the function.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Beck, A., &amp; Teboulle, M. (2009). A Fast Iterative
Shrinkage-Thresholding Algorithm for Linear Inverse Problems. SIAM
Journal on Imaging Sciences, 2(1), 183–202. <a href="https://doi.org/10.1137/080716542" class="external-link uri">https://doi.org/10.1137/080716542</a>
</li>
<li>Gong, P., Zhang, C., Lu, Z., Huang, J., &amp; Ye, J. (2013). A
general iterative shrinkage and thresholding algorithm for non-convex
regularized optimization problems. Proceedings of the 30th International
Conference on Machine Learning, 28(2)(2), 37–45.</li>
<li>Parikh, N., &amp; Boyd, S. (2013). Proximal Algorithms. Foundations
and Trends in Optimization, 1(3), 123–231.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jannik H. Orzek.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
