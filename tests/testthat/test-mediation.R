test_that("testing mediation model", {
  library(lavaan) 
  library(aCV4SEM)
  N <- 100
  
  x_0 <- rnorm(n = N, mean = 0, sd = 1)
  x_1 <- rnorm(N, mean = 0, sd = 1)
  
  mediator <- .4*x_0 + .3*x_1 + rnorm(n = N, mean = 0, sd = sqrt(.3))
  y <- .45*mediator + rnorm(n = N, mean = 0, sd = sqrt(.3))
  
  datensatz <- data.frame(x_0 = x_0,
                          x_1 = x_1,
                          mediator = mediator,
                          y = y)
  
  lavaanModell <- "mediator ~ x_0 + x_1
  y ~ mediator 
x_0 ~~ x_0
x_1 ~~ x_1
mediator ~~ mediator
y ~~ y
"
  
  fitModel <- lavaan(model = lavaanModell, data = datensatz)
  
  regsem <- regularizeSEM(lavaanModel = fitModel, 
                          regularizedParameterLabels = c("mediator~x_1"),
                          penalty = "lasso",
                          lambdas = 0)
  
  testthat::expect_equal(abs(regsem@fits$m2LL[1] - (-2*logLik(fitModel))) < 1e-3,TRUE)
  
})
